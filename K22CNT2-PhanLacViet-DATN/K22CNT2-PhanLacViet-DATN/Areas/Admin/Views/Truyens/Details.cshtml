@model K22CNT2_PhanLacViet_DATN.Models.Truyen

@{
    ViewData["Title"] = "Chi tiết truyện";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid shadow-sm p-3 mb-5 bg-white rounded">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 text-gray-800"><i class="fas fa-info-circle text-info"></i> Chi tiết truyện</h1>
        <div>
            <a asp-action="Edit" asp-route-id="@Model?.MaTruyen" class="btn btn-warning">
                <i class="fas fa-edit"></i> Chỉnh sửa
            </a>
            <a asp-action="Index" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Quay lại
            </a>
        </div>
    </div>

    <div class="row">
        <div class="col-md-4 text-center mb-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    @if (!string.IsNullOrEmpty(Model.AnhBia))
                    {
                        <img src="@Model.AnhBia" class="img-fluid rounded shadow" style="max-height: 450px; object-fit: cover;" alt="Cover" />
                    }
                    else
                    {
                        <div class="bg-light text-muted d-flex align-items-center justify-content-center rounded" style="height: 400px; border: 2px dashed #dee2e6;">
                            <i class="fas fa-image fa-4x"></i> <br> Không có ảnh bìa
                        </div>
                    }
                    <div class="mt-3">
                        <span class="badge @(Model.TrangThai == "Hoàn thành" ? "bg-success" : "bg-warning text-dark") p-2 fs-6">
                            <i class="fas fa-flag"></i> @Model.TrangThai
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-8">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="card-title mb-0"><i class="fas fa-book-open"></i> Thông tin cơ bản</h5>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold text-muted">@Html.DisplayNameFor(model => model.TenTruyen)</div>
                        <div class="col-sm-8 fs-5 fw-bold text-primary">@Html.DisplayFor(model => model.TenTruyen)</div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold text-muted">@Html.DisplayNameFor(model => model.TacGia)</div>
                        <div class="col-sm-8"><i class="fas fa-user-nib text-secondary"></i> @Html.DisplayFor(model => model.TacGia)</div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold text-muted">@Html.DisplayNameFor(model => model.LoaiTruyen)</div>
                        <div class="col-sm-8"><span class="badge bg-info">@Html.DisplayFor(model => model.LoaiTruyen)</span></div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold text-muted">Người đăng</div>
                        <div class="col-sm-8"><i class="fas fa-user-circle"></i> @Model.NguoiDangNavigation?.TaiKhoan</div>
                    </div>

                    <hr />

                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold text-muted">Thống kê</div>
                        <div class="col-sm-8">
                            <span class="me-4"><i class="fas fa-layer-group text-primary"></i> <strong>@Model.SoChuong</strong> Chương</span>
                            <span><i class="fas fa-eye text-success"></i> <strong>@Model.TongLuotXem</strong> Lượt xem</span>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold text-muted">Thời gian</div>
                        <div class="col-sm-8">
                            <div class="small text-muted"><i class="far fa-calendar-alt"></i> Ngày đăng: @Model.NgayDang?.ToString("dd/MM/yyyy HH:mm")</div>
                            <div class="small text-muted"><i class="far fa-clock"></i> Cập nhật: @Model.NgayCapNhat?.ToString("dd/MM/yyyy HH:mm")</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card shadow-sm mt-4">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0 text-dark"><i class="fas fa-align-left text-primary"></i> Mô tả truyện</h5>
                </div>
                <div class="card-body bg-light-50" style="white-space: pre-line; line-height: 1.6;">
                    @if (!string.IsNullOrEmpty(Model.MoTa))
                    {
                        @* Sử dụng Html.Raw nếu dữ liệu chứa các thẻ <div> <br> từ editor người dùng. 
                           Sử dụng white-space: pre-line để hỗ trợ dữ liệu thuần có dấu xuống dòng từ Admin.
                        *@
                        @Html.Raw(Model.MoTa)
                    }
                    else
                    {
                        <i class="text-muted small">Không có mô tả cho truyện này.</i>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .card-header {
        font-weight: bold;
    }

    .text-muted {
        font-size: 0.9rem;
    }
</style>